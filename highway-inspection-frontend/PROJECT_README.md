# 公路巡检系统前端

基于 Vue 3 + TypeScript + Vite 开发的公路无人机巡检管理系统前端应用。

## 🚀 快速开始

### 安装依赖

```bash
npm install
```

### 开发模式运行

```bash
npm run dev
```

访问：http://localhost:5173/

### 生产构建

```bash
npm run build
```

### 预览生产构建

```bash
npm run preview
```

## 📋 系统功能

### 1. 用户认证与权限管理

- **登录页面**：支持两种角色登录
  - 管理员（admin）：完整系统权限，包括空域管理、审批权限
  - 操作员（operator）：飞行申请、视频查看权限
- **权限控制**：基于角色的功能访问控制

### 2. 地图总览

- ✅ **实时地图显示**
  - Leaflet 地图引擎
  - OpenStreetMap 底图
  - 无人机位置标记
  - 空域多边形显示
  
- ✅ **交互功能**
  - 点击无人机查看详情
  - 定位按钮回到中心
  - 查看无人机视频画面

### 3. 视频巡检

- ✅ **视频管理**
  - 导入本地视频（MP4, AVI等）
  - 实时视频流接入（RTMP/RTSP）
  - 视频元数据记录（任务ID、采集时间、路段、无人机编号）

- ✅ **视频播放**
  - HTML5 视频播放器
  - 拖拽上传支持
  - 视频列表管理

- ✅ **智能分析**
  - 检测结果展示（实时事件、目标识别）
  - AI识别框叠加（预留接口）
  - 置信度显示

### 4. 飞行申请管理

- ✅ **申请创建**（操作员）
  - 完整申请表单
  - 无人机选择
  - 空域选择
  - 时间规划
  - 草稿保存
  
- ✅ **申请审批**（管理员）
  - 待审批列表
  - 审批详情查看
  - 批准/驳回操作
  - 审批意见填写

- ✅ **状态跟踪**
  - 草稿 → 待审批 → 已批准/已驳回 → 已过期
  - 放飞申请
  - 放飞审批

- ✅ **CRUD操作**（管理员）
  - 增删改查所有申请
  - 数据管理

### 5. 空域管理

- ✅ **空域可视化**
  - 地图多边形绘制
  - 颜色编码（适飞区、限制区、禁飞区）
  - 状态显示（可用、占用、不可用）

- ✅ **空域管理**（空域管理员/管理员）
  - 创建空域（坐标点、高度范围）
  - 编辑空域
  - 删除空域
  - 状态管理

- ✅ **查询功能**（所有角色）
  - 空域列表查看
  - 搜索筛选
  - 详细信息展示
  - 只读访问（操作员）

### 6. 告警中心

- ✅ **告警管理**
  - 告警记录（ID、类型、置信度、位置、时间）
  - 告警类型
    - 交通事故
    - 路况异常（积水、积雪、路面损坏）
    - 设施异常（标志牌、护栏）
    - 空域侵入
    - 碰撞风险
    - 状态异常
    - 气象预警

- ✅ **告警处理**
  - 确认告警
  - 分派处理
  - 解决告警
  - 关闭告警
  - 状态追踪（新发现→已确认→处理中→已解决→已关闭）

- ✅ **告警展示**
  - 统计卡片（严重、高级、中级告警）
  - 列表筛选（类型、等级、状态、时间）
  - 详情展示（关联视频、飞行任务）
  - 置信度显示

### 7. 数据看板

- ✅ **飞行统计**
  - 任务总数
  - 总飞行时长
  - 总飞行里程
  - 飞行趋势图

- ✅ **空域利用统计**
  - 空域使用频率
  - 空域利用率饼图
  - 空域状态分布

- ✅ **告警统计**
  - 告警总数
  - 告警类型分布
  - 告警趋势图
  - 各类告警数量

- ✅ **巡检成果统计**
  - 发现事件总数
  - 各类事件占比
  - 已处理/未处理统计
  - 高频问题路段 TOP10

- ✅ **图表可视化**
  - ECharts 图表
  - 柱状图、折线图、饼图
  - 交互式数据展示
  - 时间范围筛选

### 8. 用户管理

- 📝 用户增删改查（预留）
- 📝 角色分配（预留）
- 📝 权限管理（预留）

### 9. 设备管理

- 📝 无人机信息管理（预留）
- 📝 设备状态管理（预留）

## 🛠️ 技术栈

### 核心框架
- **Vue 3.5** - 渐进式JavaScript框架
- **TypeScript** - 类型安全
- **Vite 7.1** - 构建工具

### UI 组件
- **Element Plus 2.11** - UI组件库
- **@element-plus/icons-vue** - 图标库

### 状态管理
- **Pinia 3.0** - Vue 状态管理

### 路由
- **Vue Router 4.6** - 路由管理

### 地图
- **Leaflet 1.9** - 地图引擎
- **leaflet.markercluster** - 标记聚合
- **@turf/turf** - 地理空间分析

### 数据可视化
- **ECharts 6.0** - 图表库
- **vue-echarts 8.0** - Vue ECharts 组件

### 视频播放
- **xgplayer** - 西瓜播放器
- **xgplayer-flv** - FLV 支持
- **hls.js** - HLS 支持
- **flv.js** - FLV 支持

### 网络通信
- **Axios 1.13** - HTTP 客户端
- **socket.io-client** - WebSocket 客户端

### 工具库
- **dayjs** - 日期时间处理

### 开发工具
- **unplugin-auto-import** - 自动导入
- **unplugin-vue-components** - 组件自动导入

## 📁 项目结构

```
highway-inspection-frontend/
├── src/
│   ├── api/                    # API 接口
│   │   ├── index.ts           # Axios 实例配置
│   │   └── modules.ts         # API 模块（视频、地图、飞行、告警等）
│   ├── assets/                # 静态资源
│   │   └── styles/
│   │       └── global.css     # 全局样式
│   ├── components/            # 公共组件
│   ├── layouts/               # 布局组件
│   │   └── MainLayout.vue     # 主布局（侧边栏+头部）
│   ├── plugins/               # 插件
│   │   └── element.ts         # Element Plus 配置
│   ├── router/                # 路由配置
│   │   └── index.ts           # 路由定义
│   ├── stores/                # Pinia 状态管理
│   │   ├── index.ts           # Store 入口
│   │   ├── user.ts            # 用户状态
│   │   ├── map.ts             # 地图状态
│   │   ├── flight.ts          # 飞行申请状态
│   │   ├── airspace.ts        # 空域状态
│   │   └── alert.ts           # 告警状态
│   ├── views/                 # 页面组件
│   │   ├── Login.vue          # 登录页
│   │   ├── Map.vue            # 地图总览
│   │   ├── Video.vue          # 视频巡检
│   │   ├── Flights.vue        # 飞行申请
│   │   ├── Airspace.vue       # 空域管理
│   │   ├── Alerts.vue         # 告警中心
│   │   ├── Dashboard.vue      # 数据看板
│   │   ├── Users.vue          # 用户管理
│   │   └── Devices.vue        # 设备管理
│   ├── App.vue                # 根组件
│   └── main.ts                # 入口文件
├── public/                    # 公共资源
├── package.json               # 依赖配置
├── tsconfig.json              # TypeScript 配置
├── vite.config.ts             # Vite 配置
└── README.md                  # 项目说明
```

## 🎯 核心功能说明

### 权限控制

系统实现基于角色的访问控制（RBAC）：

- **管理员（admin）**
  - ✅ 所有功能完整权限
  - ✅ 删除操作权限
  - ✅ 用户管理
  - ✅ 设备管理
  - ✅ 飞行申请审批
  - ✅ 空域管理（增删改查）
  - ✅ 放飞审批
  - ✅ 告警处理

- **操作员（operator）**
  - ✅ 创建飞行申请
  - ✅ 查看自己的申请
  - ✅ 申请放飞
  - ✅ 查看空域（只读）
  - ✅ 告警确认
  - ❌ 无删除敏感数据权限
  - ❌ 审批操作
  - ❌ 修改空域

### 数据流程

#### 飞行申请流程
1. 操作员创建申请 → 填写表单 → 保存草稿/提交
2. 管理员收到申请 → 审批 → 批准/驳回
3. 操作员查看结果 → 申请放飞
4. 管理员批准放飞 → 系统校验 → 准许/暂缓

#### 空域管理流程
1. 管理员创建空域 → 设置坐标和属性 → 保存
2. 系统在地图上绘制多边形 → 显示状态
3. 用户查看空域 → 搜索筛选
4. 管理员修改状态 → 记录历史 → 更新地图

#### 告警处理流程
1. 系统/AI检测到异常 → 生成告警记录
2. 操作员确认告警 → 分派处理人
3. 处理人处理告警 → 标记已解决
4. 管理员审核 → 关闭告警

## 🔧 开发指南

### 环境要求

- Node.js >= 18.0.0
- npm >= 9.0.0

### 开发模式

```bash
# 启动开发服务器
npm run dev

# 开发服务器默认运行在 http://localhost:5173/
```

### API 配置

在 `.env` 文件中配置后端API地址：

```env
VITE_API_BASE_URL=http://localhost:3000/api
```

### 添加新功能模块

1. 在 `src/stores/` 创建状态管理
2. 在 `src/views/` 创建页面组件
3. 在 `src/router/index.ts` 添加路由
4. 在 `src/api/modules.ts` 添加API接口

## 📝 待开发功能

- [ ] 实时视频流播放（WebRTC/RTSP）
- [ ] AI识别框实时叠加
- [ ] WebSocket 实时告警推送
- [ ] 用户管理界面
- [ ] 设备管理界面
- [ ] 情报服务模块
- [ ] 数据导出功能
- [ ] 移动端适配

## 🎨 界面预览

### 登录页
- 支持三种角色选择
- 用户名/密码登录（演示版本）

### 主界面
- 侧边栏导航
- 顶部用户信息
- 响应式布局

### 地图总览
- 实时地图显示
- 无人机标记
- 空域多边形
- 信息弹窗

### 飞行申请
- 申请表单
- 申请列表
- 状态筛选
- 审批界面

### 空域管理
- 地图+列表双视图
- 空域绘制
- 状态管理
- 权限控制

### 告警中心
- 统计卡片
- 告警列表
- 处理流程
- 详情展开

### 数据看板
- 多维度统计
- 图表可视化
- 时间范围筛选
- 实时数据

## 📄 许可证

MIT License

## 👥 贡献者

- 开发团队

## 📮 联系方式

如有问题，请联系开发团队。

